<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Vegetation data ordination â€¢ ecositer</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vegetation data ordination">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecositer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/accessing_vegetation_data.html">Accessing vegetation data</a></li>
    <li><a class="dropdown-item" href="../articles/ordinating_vegetation_data.html">Vegetation data ordination</a></li>
    <li><a class="dropdown-item" href="../articles/qc_vegetation_data.html">QC vegetation data</a></li>
    <li><a class="dropdown-item" href="../articles/summarizing_ecological_data.html">Summarizing ecological data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/natearoe/ecositer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="ordinating_vegetation_data_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="ordinating_vegetation_data_files/plotly-binding-4.10.4/plotly.js"></script><script src="ordinating_vegetation_data_files/typedarray-0.1/typedarray.min.js"></script><link href="ordinating_vegetation_data_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="ordinating_vegetation_data_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="ordinating_vegetation_data_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="ordinating_vegetation_data_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vegetation data ordination</h1>
                        <h4 data-toc-skip class="author">Nathan Roe</h4>
            
            <h4 data-toc-skip class="date">2025-01-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/natearoe/ecositer/blob/main/vignettes/ordinating_vegetation_data.Rmd" class="external-link"><code>vignettes/ordinating_vegetation_data.Rmd</code></a></small>
      <div class="d-none name"><code>ordinating_vegetation_data.Rmd</code></div>
    </div>

    
    
<p>Ordination is a multivariate statistical technique that is
well-suited for analyzing ecological communities. Ordination allows for
many ecologically useful relationships to be evaluated - all
correlative, of course (this is ecology after all) - including: <br> -
similarity/dissimilarity in vegetative composition between sites <br> -
relationship between community classifications and environmental
gradients <br> - relationship between community classifications and
species <br> - relationship between species and environmental gradients
<br></p>
<p>This vignette is not intended to explain the mechanics of ordination
techniques, distance measures, or how to interpret ordination results.
There are many excellent sources for this purpose. I would recommend
reading <a href="https://www.researchgate.net/publication/216769990_Analysis_of_Ecological_Communities" class="external-link">Analysis
of Ecological Communities by McCune and Grace</a> for a primer on these
topics.</p>
<p>In this vignette I will present the use of Non-metric
Multidimensional Scaling (NMDS) with a Bray-Curtis distance measure for
creating an ordination. Much of the workflow will not be built into
<code>ecositer</code> functions because it relies heavily on functions
from other packages, and incorporating them into functions will conceal
too many of parameters that can be, and should be, manipulated in this
process.</p>
<p>I will be using the CA792 (Sequoia and Kings Canyon National Park)
Soil Survey for this demonstration.</p>
<p>For this example, I will be working with pedon and vegetation data
stored in the <code>ecositer.data</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">CA792_pedon_data</span>, package <span class="op">=</span> <span class="st">"ecositer.data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">CA792_veg_data</span>, package <span class="op">=</span> <span class="st">"ecositer.data"</span><span class="op">)</span></span></code></pre></div>
<p>Additional summary soil variable calculation, as demonstrated in the
<a href="https://natearoe.github.io/ecositer/articles/summarizing_ecological_data.html">Summarize
Ecological Data vignette</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_pedon_summary</span> <span class="op">&lt;-</span> <span class="fu">ecositer</span><span class="fu">::</span><span class="fu"><a href="../reference/summarize_pedon_soil_properties.html">summarize_pedon_soil_properties</a></span><span class="op">(</span>SS <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                           r_object <span class="op">=</span> <span class="va">CA792_pedon_data</span>,</span>
<span>                                           byDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in max(h[[bottom]][no.contact.idx], na.rm = TRUE): no non-missing</span></span>
<span><span class="co">## arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in aqp::texcl_to_ssc(x$texcl): not all the user supplied texcl values</span></span>
<span><span class="co">## match the lookup table</span></span>
<span><span class="co">## Warning in aqp::texcl_to_ssc(x$texcl): not all the user supplied texcl values</span></span>
<span><span class="co">## match the lookup table</span></span>
<span><span class="co">## Warning in aqp::texcl_to_ssc(x$texcl): not all the user supplied texcl values</span></span>
<span><span class="co">## match the lookup table</span></span></code></pre>
<p>Climate variable calculation, as demonstrated in the <a href="https://natearoe.github.io/ecositer/articles/summarizing_ecological_data.html">Summarize
Ecological Data vignette</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_clim</span> <span class="op">&lt;-</span> <span class="fu">ecositerSpatial</span><span class="fu">::</span><span class="fu"><a href="https://natearoe.github.io/ecositer/reference/site_prism_annual_normals.html">site_prism_annual_normals</a></span><span class="op">(</span>site_df <span class="op">=</span> <span class="va">CA792_veg_data</span>,</span>
<span>                                           prism_dir <span class="op">=</span> <span class="st">"C:/Users/Nathan.Roe/Documents/PRISM_R/annual"</span>,</span>
<span>                                           id <span class="op">=</span> <span class="st">"siteiid"</span>,</span>
<span>                                           x <span class="op">=</span> <span class="st">"utmeasting"</span>,</span>
<span>                                           y <span class="op">=</span> <span class="st">"utmnorthing"</span>,</span>
<span>                                           EPSG <span class="op">=</span> <span class="st">"EPSG:32611"</span><span class="op">)</span></span></code></pre></div>
<p>Run through QC functions for vegetation data</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_veg_data</span> <span class="op">&lt;-</span> <span class="fu">ecositer</span><span class="fu">::</span><span class="fu"><a href="../reference/QC_aggregate_abundance.html">QC_aggregate_abundance</a></span><span class="op">(</span>veg_df <span class="op">=</span> <span class="va">CA792_veg_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Note -&gt; akstratumcoverclasspct is the only abundance column used in this dataset</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># manual review process because of multiple vegplots for sites with tied number of records</span></span>
<span><span class="va">CA792_veg_data</span> <span class="op">&lt;-</span> <span class="va">CA792_veg_data</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">vegplotiid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">276394</span>, <span class="fl">276184</span>, <span class="fl">276395</span>, <span class="fl">276185</span>, <span class="fl">276228</span>, <span class="fl">196369</span>, <span class="fl">990978</span>, <span class="fl">954117</span>, <span class="fl">316789</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now we can run QC_best_vegplot without error</span></span>
<span><span class="va">CA792_veg_data</span> <span class="op">&lt;-</span> <span class="fu">ecositer</span><span class="fu">::</span><span class="fu"><a href="../reference/QC_best_vegplot_for_site.html">QC_best_vegplot_for_site</a></span><span class="op">(</span>veg_df <span class="op">=</span> <span class="va">CA792_veg_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning -&gt; There are sites with multiple vegetation plots. Reviewing these sites is preferable to automated selection. To view which sites have multiple vegetation plots:</span></span>
<span><span class="co">##               'Your veg_df' |&gt; dplyr::group_by(siteiid) |&gt;</span></span>
<span><span class="co">##                                dplyr::summarise(unique_vegplots = dplyr::n_distinct(vegplotiid)) |&gt;</span></span>
<span><span class="co">##                                dplyr::filter(unique_vegplots &gt; 1)</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_veg_data</span> <span class="op">&lt;-</span> <span class="fu">ecositer</span><span class="fu">::</span><span class="fu"><a href="../reference/QC_update_taxonomy.html">QC_update_taxonomy</a></span><span class="op">(</span>veg_df <span class="op">=</span> <span class="va">CA792_veg_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Note -&gt; The following taxonomical changes have been made.</span></span></code></pre>
<pre><code><span><span class="co">## Castanopsis sempervirens changed to Chrysolepis sempervirens </span></span>
<span><span class="co">## Yucca whipplei changed to Hesperoyucca whipplei </span></span>
<span><span class="co">## Disporum hookeri var. oreganum changed to Prosartes hookeri var. oregana </span></span>
<span><span class="co">## Quercus garryana var. breweri changed to Quercus garryana var. fruticosa </span></span>
<span><span class="co">## Rhodomyrtus tomentosus changed to Rhodomyrtus tomentosa </span></span>
<span><span class="co">## Juncus balticus changed to Juncus arcticus ssp. littoralis </span></span>
<span><span class="co">## Salix arctica changed to Salix arctica </span></span>
<span><span class="co">## Pinus latifolia changed to Pinus engelmannii </span></span>
<span><span class="co">## Castilleja acuminata changed to Castilleja septentrionalis </span></span>
<span><span class="co">## Ceanothus integerrimus var. californicus changed to Ceanothus integerrimus </span></span>
<span><span class="co">## Juniperus occidentalis ssp. australis changed to Juniperus grandis </span></span>
<span><span class="co">## Cymopterus terebinthinus changed to Pteryxia terebinthina var. terebinthina </span></span>
<span><span class="co">## Sambucus cerulea changed to Sambucus nigra ssp. cerulea </span></span>
<span><span class="co">## Chrysothamnus nauseosus changed to Ericameria nauseosa ssp. nauseosa var. nauseosa </span></span>
<span><span class="co">## Vaccinium caespitosum changed to Vaccinium cespitosum </span></span>
<span><span class="co">## Acacia constricta changed to Vachellia constricta </span></span>
<span><span class="co">## Hosackia oblongifolia changed to Lotus oblongifolius var. oblongifolius </span></span>
<span><span class="co">## Vaccinium uliginosum ssp. occidentale changed to Vaccinium uliginosum </span></span>
<span><span class="co">## Platanthera leucostachys changed to Platanthera dilatata var. leucostachys </span></span>
<span><span class="co">## Cercocarpus betuloides var. betuloides changed to Cercocarpus montanus var. glaber </span></span>
<span><span class="co">## Heracleum lanatum changed to Heracleum maximum </span></span>
<span><span class="co">## Ribes cereum var. inebrians changed to Ribes cereum var. pedicellare </span></span>
<span><span class="co">## Cercis occidentalis changed to Cercis canadensis var. texensis </span></span>
<span><span class="co">## Cercocarpus betuloides changed to Cercocarpus montanus var. glaber </span></span>
<span><span class="co">## Acacia millefolia changed to Mariosousa millefolia </span></span>
<span><span class="co">## Anemone occidentalis changed to Pulsatilla occidentalis </span></span>
<span><span class="co">## Smilacina stellata changed to Maianthemum stellatum </span></span>
<span><span class="co">## Aster breweri changed to Eucephalus breweri </span></span>
<span><span class="co">## Artemisia norvegica ssp. saxatilis changed to Artemisia arctica ssp. arctica </span></span>
<span><span class="co">## Calyptridium monospermum changed to Cistanthe monosperma </span></span>
<span><span class="co">## Rhamnus rubra changed to Frangula rubra ssp. rubra </span></span>
<span><span class="co">## Penstemon newberryi var. newberryi changed to Penstemon newberryi ssp. newberryi </span></span>
<span><span class="co">## Deschampsia cespitosa ssp. cespitosa changed to Deschampsia cespitosa </span></span>
<span><span class="co">## Caltha leptosepala var. biflora changed to Caltha leptosepala ssp. howellii </span></span>
<span><span class="co">## Sedum roseum changed to Rhodiola rosea </span></span>
<span><span class="co">## Eremocarpus setigerus changed to Croton setigerus </span></span>
<span><span class="co">## Caulanthus coulteri var. lemmonii changed to Caulanthus lemmonii </span></span>
<span><span class="co">## Calyptridium umbellatum changed to Cistanthe umbellata var. umbellata </span></span>
<span><span class="co">## Micranthes tolmiei changed to Saxifraga tolmiei</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_veg_data</span> <span class="op">&lt;-</span> <span class="fu">ecositer</span><span class="fu">::</span><span class="fu"><a href="../reference/QC_completeness_criteria.html">QC_completeness_criteria</a></span><span class="op">(</span>veg_df <span class="op">=</span> <span class="va">CA792_veg_data</span>,</span>
<span>                                                     min_unique_species <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                                     min_perc_to_species <span class="op">=</span> <span class="fl">70</span>,</span>
<span>                                                     min_perc_with_abund <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span></code></pre></div>
<p>Remove reccords with missing abundance or missing plantsym. Remove
genus level observations.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_veg_data</span> <span class="op">&lt;-</span> <span class="va">CA792_veg_data</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pct_cover</span><span class="op">)</span> <span class="op">|</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">plantsym</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">species_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">" "</span>, x <span class="op">=</span> <span class="va">CA792_veg_data</span><span class="op">$</span><span class="va">plantsciname</span><span class="op">)</span></span>
<span><span class="va">CA792_veg_data</span> <span class="op">&lt;-</span> <span class="va">CA792_veg_data</span><span class="op">[</span><span class="va">species_level</span>,<span class="op">]</span></span></code></pre></div>
<p>Sum species abundances together when there are multiple records of
the same species in the same vegplotiid. This is usually the result of
species occurring in different strata.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_veg_data</span> <span class="op">&lt;-</span> <span class="va">CA792_veg_data</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">siteiid</span>, <span class="va">usiteid</span>, <span class="va">vegplotiid</span>, <span class="va">ecositeid</span>, <span class="va">ecostateid</span>, <span class="va">commphaseid</span>, <span class="va">plantsym</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>pct_cover <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pct_cover</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span></code></pre></div>
<p>Pivot data wider - preferred for ordination</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grouping_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"siteiid"</span>, <span class="st">"usiteid"</span>, <span class="st">"vegplotiid"</span>, <span class="st">"ecositeid"</span>, <span class="st">"ecostateid"</span>, <span class="st">"commphaseid"</span>, <span class="st">"plantsym"</span>, <span class="st">"pct_cover"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CA792_veg_data_wide</span> <span class="op">&lt;-</span> <span class="va">CA792_veg_data</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">grouping_columns</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">plantsym</span>, values_from <span class="op">=</span> <span class="va">pct_cover</span><span class="op">)</span></span></code></pre></div>
<p>Restrict to just one LRU. Restricting to one LRU make it easier to
visualize all the ecosites with colors and provide a more concentrated
focus on a smaller number of sites.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"AD"</span>, x <span class="op">=</span> <span class="va">CA792_veg_data_wide</span><span class="op">$</span><span class="va">ecositeid</span><span class="op">)</span></span>
<span><span class="co">#AB &lt;- grep(pattern = "AH", x = CA792_veg_data_wide$ecositeid)</span></span>
<span></span>
<span><span class="va">CA792_veg_data_wide</span> <span class="op">&lt;-</span> <span class="va">CA792_veg_data_wide</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">AD</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Before removing rare species, I am going to assemble the
environmental dataframe, as this is likely to have a considerable amount
of missing data and will likely restrict what sites are included in the
analysis more than rare species.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_site_props</span> <span class="op">&lt;-</span> <span class="fu">aqp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/aqp/man/site.html" class="external-link">site</a></span><span class="op">(</span><span class="va">CA792_pedon_summary</span><span class="op">$</span><span class="va">full_profile</span><span class="op">)</span></span>
<span></span>
<span><span class="va">columns_of_interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"siteiid"</span>, <span class="st">"slope_field"</span>, <span class="st">"elev_field"</span>, <span class="st">"d_L_lowest_mineral"</span>, <span class="st">"m_L_lowest_mineral"</span>,</span>
<span>                         <span class="st">"o_surf_thk"</span>, <span class="st">"full_prof_clay_wtd"</span>, <span class="st">"full_prof_ph_wtd"</span>, </span>
<span>                         <span class="st">"full_prof_frag_vol_tot_wtd"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">CA792_site_props</span><span class="op">[</span><span class="va">columns_of_interest</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">CA792_site_props</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span> </span></code></pre></div>
<pre><code><span><span class="co">##                    siteiid                slope_field </span></span>
<span><span class="co">##                  100.00000                   98.43478 </span></span>
<span><span class="co">##                 elev_field         d_L_lowest_mineral </span></span>
<span><span class="co">##                  100.00000                   88.34783 </span></span>
<span><span class="co">##         m_L_lowest_mineral                 o_surf_thk </span></span>
<span><span class="co">##                   88.34783                  100.00000 </span></span>
<span><span class="co">##         full_prof_clay_wtd           full_prof_ph_wtd </span></span>
<span><span class="co">##                   98.86957                   92.60870 </span></span>
<span><span class="co">## full_prof_frag_vol_tot_wtd </span></span>
<span><span class="co">##                  100.00000</span></span></code></pre>
<p>I am going to remove d_L_lowest_mineral and m_L_lowest_mineral.
Remember, any missing value in any column leads to the entire row (site)
being removed. It is a difficult balance deciding what environmental
variables to keep at the cost of losing sites.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_site_props_reduced</span> <span class="op">&lt;-</span> <span class="va">CA792_site_props</span><span class="op">[</span>, <span class="va">columns_of_interest</span><span class="op">[</span><span class="op">!</span><span class="va">columns_of_interest</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d_L_lowest_mineral"</span>, <span class="st">"m_L_lowest_mineral"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Joining in climate data</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_site_props_reduced</span><span class="op">$</span><span class="va">siteiid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">CA792_site_props_reduced</span><span class="op">$</span><span class="va">siteiid</span><span class="op">)</span></span>
<span><span class="va">CA792_site_props_reduced</span> <span class="op">&lt;-</span> <span class="va">CA792_site_props_reduced</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">CA792_clim</span><span class="op">)</span></span></code></pre></div>
<p>Remove rows with any NA values</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_env_df</span> <span class="op">&lt;-</span> <span class="va">CA792_site_props_reduced</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">CA792_site_props_reduced</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>98 sites were lost, 1052 remain - not bad! Now we will reduce the veg
data down to just those sites that are in the environmental
dataframe.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_veg_data_wide</span> <span class="op">&lt;-</span> <span class="va">CA792_veg_data_wide</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">siteiid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">CA792_env_df</span><span class="op">$</span><span class="va">siteiid</span><span class="op">)</span></span></code></pre></div>
<p>Create species only dataframe - all group columns removed. This is
common in the ordination process.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_comm_df</span> <span class="op">&lt;-</span> <span class="va">CA792_veg_data_wide</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">CA792_veg_data_wide</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CA792_comm_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">CA792_comm_df</span><span class="op">$</span><span class="va">siteiid</span> </span>
<span><span class="va">CA792_comm_df</span> <span class="op">&lt;-</span> <span class="va">CA792_comm_df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">CA792_comm_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">CA792_comm_df</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<p>Remove rare species</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">frequency_threshold</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">CA792_comm_df</span> <span class="op">&lt;-</span> <span class="va">CA792_comm_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">CA792_comm_df</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">frequency_threshold</span><span class="op">]</span></span></code></pre></div>
<p>Remove sites that have not species after rare species are removed</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_comm_df</span> <span class="op">&lt;-</span> <span class="va">CA792_comm_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">CA792_comm_df</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>,<span class="op">]</span></span></code></pre></div>
<p>There are 296 siteids in veg dataset, so we are more restricted by
veg data and environment, generally speaking. We do need to now reduce
the environmental dataframe to only include siteiids in the veg
data.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># will improve this to avoid using rownames in this way in the future</span></span>
<span><span class="va">CA792_env_df</span> <span class="op">&lt;-</span> <span class="va">CA792_env_df</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">siteiid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CA792_comm_df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There are a couple of siteiids in the environmental data that have
multiple rows. This is caused by lab data. For this purpose, I am just
going to take the first record. For a real analysis, these should be
inspected and the best record chosen.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CA792_env_df</span> <span class="op">&lt;-</span> <span class="va">CA792_env_df</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">siteiid</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Begin ordination</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_nmds</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html" class="external-link">metaMDS</a></span><span class="op">(</span><span class="va">CA792_comm_df</span>, autotransform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Square root transformation</span></span>
<span><span class="co">## Wisconsin double standardization</span></span>
<span><span class="co">## Run 0 stress 0.2229301 </span></span>
<span><span class="co">## Run 1 stress 0.2238546 </span></span>
<span><span class="co">## Run 2 stress 0.2241674 </span></span>
<span><span class="co">## Run 3 stress 0.2242332 </span></span>
<span><span class="co">## Run 4 stress 0.2238695 </span></span>
<span><span class="co">## Run 5 stress 0.2240236 </span></span>
<span><span class="co">## Run 6 stress 0.2236443 </span></span>
<span><span class="co">## Run 7 stress 0.2241277 </span></span>
<span><span class="co">## Run 8 stress 0.224291 </span></span>
<span><span class="co">## Run 9 stress 0.2253973 </span></span>
<span><span class="co">## Run 10 stress 0.2237568 </span></span>
<span><span class="co">## Run 11 stress 0.223833 </span></span>
<span><span class="co">## Run 12 stress 0.2242867 </span></span>
<span><span class="co">## Run 13 stress 0.2233153 </span></span>
<span><span class="co">## ... Procrustes: rmse 0.007346952  max resid 0.06169108 </span></span>
<span><span class="co">## Run 14 stress 0.2235029 </span></span>
<span><span class="co">## Run 15 stress 0.2232925 </span></span>
<span><span class="co">## ... Procrustes: rmse 0.015232  max resid 0.1798811 </span></span>
<span><span class="co">## Run 16 stress 0.2246379 </span></span>
<span><span class="co">## Run 17 stress 0.222944 </span></span>
<span><span class="co">## ... Procrustes: rmse 0.006576951  max resid 0.05983765 </span></span>
<span><span class="co">## Run 18 stress 0.2241744 </span></span>
<span><span class="co">## Run 19 stress 0.2240259 </span></span>
<span><span class="co">## Run 20 stress 0.2240704 </span></span>
<span><span class="co">## *** Best solution was not repeated -- monoMDS stopping criteria:</span></span>
<span><span class="co">##     19: stress ratio &gt; sratmax</span></span>
<span><span class="co">##      1: scale factor of the gradient &lt; sfgrmin</span></span></code></pre>
<p>Envfit</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env.envfit</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/envfit.html" class="external-link">envfit</a></span><span class="op">(</span><span class="va">my_nmds</span>, <span class="va">CA792_env_df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, permutations <span class="op">=</span> <span class="fl">9999</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">species.envfit</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/envfit.html" class="external-link">envfit</a></span><span class="op">(</span><span class="va">my_nmds</span>, <span class="va">CA792_comm_df</span>, permutation<span class="op">=</span> <span class="fl">9999</span><span class="op">)</span></span></code></pre></div>
<p>Species scores</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species.scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">my_nmds</span>, <span class="st">"species"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"species"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>pval <span class="op">=</span> <span class="va">species.envfit</span><span class="op">$</span><span class="va">vectors</span><span class="op">$</span><span class="va">pvals</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p>Site scores</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site.scrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">my_nmds</span>, display <span class="op">=</span> <span class="st">"sites"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"siteiid"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">CA792_veg_data_wide</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">usiteid</span>, <span class="va">siteiid</span>, <span class="va">ecositeid</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Environmental scores</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env.scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">env.envfit</span>, display <span class="op">=</span> <span class="st">"vectors"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"env.variables"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">env.scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">env.scores</span>, pval <span class="op">=</span> <span class="va">env.envfit</span><span class="op">$</span><span class="va">vectors</span><span class="op">$</span><span class="va">pvals</span>,</span>
<span>                    r <span class="op">=</span> <span class="va">env.envfit</span><span class="op">$</span><span class="va">vectors</span><span class="op">$</span><span class="va">r</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig.env.scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">env.scores</span>, <span class="va">r</span> <span class="op">&gt;=</span> <span class="fl">0.02</span><span class="op">)</span></span></code></pre></div>
<p>Plotting ordination</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># plotting</span></span>
<span>  <span class="va">pointSize</span> <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="va">textSize</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="va">spaceLegend</span> <span class="op">=</span> <span class="fl">0.3</span></span>
<span></span>
<span>  <span class="va">bar</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">site.scrs</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NMDS1</span>, y <span class="op">=</span> <span class="va">NMDS2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ecositeid</span><span class="op">)</span>,</span>
<span>                   text <span class="op">=</span> <span class="va">usiteid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Presence absence NMDS"</span>, color <span class="op">=</span> <span class="st">"Ecosite"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">pointSize</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           color <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">pointSize</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">textSize</span><span class="op">)</span>,</span>
<span>          legend.text  <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">textSize</span><span class="op">)</span>,</span>
<span>          legend.key.size <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="va">spaceLegend</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">species.scores</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NMDS1</span>, y <span class="op">=</span> <span class="va">NMDS2</span>, label <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sig.env.scores</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, xend <span class="op">=</span> <span class="va">NMDS1</span>, y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                        yend <span class="op">=</span> <span class="va">NMDS2</span><span class="op">)</span>,</span>
<span>                 arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 colour <span class="op">=</span> <span class="st">"grey10"</span>, lwd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sig.env.scores</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NMDS1</span>, y <span class="op">=</span> <span class="va">NMDS2</span>,</span>
<span>                                     label <span class="op">=</span> <span class="va">env.variables</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in ggplot2::geom_point(ggplot2::aes(color = factor(ecositeid), text =</span></span>
<span><span class="co">## usiteid)): Ignoring unknown aesthetics: <span style="color: #00BB00;">text</span></span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">bar</span>, tooltip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="st">"color"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">825</span>, height <span class="op">=</span> <span class="fl">700</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:825px;height:700px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"data":[{"x":[-0.03115979034208044,-0.20003805193193336,-0.41835748443951559,-0.77201264695584026,-0.029381385705370484,-0.92717579170087328,-0.34661835653038747,-0.84636303677541247],"y":[-0.96703839445794137,0.16368380799968385,-0.15088698777018669,-0.17128601819172293,0.38163838341391004,-0.3713855285547189,-0.21842717899115016,-0.098709187979412458],"text":["factor(ecositeid): F022AD100CA<br />2019CA7925014","factor(ecositeid): F022AD100CA<br />2012CA7922004","factor(ecositeid): F022AD100CA<br />2012CA7922008","factor(ecositeid): F022AD100CA<br />2012CA7921065","factor(ecositeid): F022AD100CA<br />2012CA7929004","factor(ecositeid): F022AD100CA<br />2013CA7929901","factor(ecositeid): F022AD100CA<br />2013CA7929102","factor(ecositeid): F022AD100CA<br />2013CA7929109"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"F022AD100CA","legendgroup":"F022AD100CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.48296058397980551,-0.63260465940258426,-0.71792457312396873,-0.44888150261453802],"y":[-0.56052751828491842,-0.281400737549998,-0.35945059457759704,-0.20222876078146573],"text":["factor(ecositeid): F022AD101CA<br />2016CA7921033","factor(ecositeid): F022AD101CA<br />2014CA7925072","factor(ecositeid): F022AD101CA<br />2014CA7925070","factor(ecositeid): F022AD101CA<br />2014CA7921063"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(227,137,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(227,137,0,1)"}},"hoveron":"points","name":"F022AD101CA","legendgroup":"F022AD101CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.3580965774398428,-0.053090592428972384,-0.021521537283328913,0.19442855773044393,0.6390760265904295,0.31815965191742485,0.53749530793158162,0.44363975628651192,0.601508869828703,-0.23326847545508503,-0.10059184659358783,-0.025616854800696844,0.63011801995440064,0.51144182224559065,0.64490794498947979,0.29761228739094314,0.19887982886916655,0.34302609795317146,0.18884891909021972,0.78168812244899277,-0.59293936283907633,-0.25292551708839317,0.35155371870640034,0.46428104485992167,0.43390161807847416,-0.44224175760461643,-0.64312923933848454,0.11042619386043041,-0.091419782730209412,-0.30888639616022256,0.37774331733592137,0.35862890059308566,-0.33531495794839117,0.47738927138111725,0.078944789383707858,-0.40347390534033201,0.56827748337623674,-0.23801788196965168,0.43464435157893616,-0.19648129481810581],"y":[-0.65499427968808022,-0.75404162197656099,-1.0221337607848109,-0.053144533277147035,-0.44577349689996171,-0.64660665198515033,-0.60647239793306051,0.27706412876667758,-0.3707728169228024,-0.83892478104992996,-0.12625325679599536,-0.63171707604810834,-0.0042876696911967093,-0.43159189995848368,-0.41477305563031536,-0.073635233529421085,0.55515466594238394,0.20905984477620077,0.22506325376904243,-0.46846597751106389,-0.2769028300813195,-0.67257150329145066,-0.41430983895361989,-0.60117476057244934,0.052445034112722382,-0.57204130437588452,-0.46280313535446022,-0.81566206726109747,0.1608506398578225,-0.47457864870086891,0.15539922920882593,0.13366472163206117,-0.44151768346517678,-0.35335272257222761,-0.66088203235526433,0.17168167415101981,-0.46304329415600493,-0.30974134973823475,-0.49333148268123039,-0.09735806859835297],"text":["factor(ecositeid): F022AD102CA<br />2014CA7922026","factor(ecositeid): F022AD102CA<br />2014CA7922028","factor(ecositeid): F022AD102CA<br />2014CA7922033","factor(ecositeid): F022AD102CA<br />2015CA7923029","factor(ecositeid): F022AD102CA<br />2015CA7923030","factor(ecositeid): F022AD102CA<br />2015CA7923031","factor(ecositeid): F022AD102CA<br />2015CA7923036","factor(ecositeid): F022AD102CA<br />2015CA7925038","factor(ecositeid): F022AD102CA<br />2015CA7925025","factor(ecositeid): F022AD102CA<br />2015CA7926013","factor(ecositeid): F022AD102CA<br />2015CA7923087","factor(ecositeid): F022AD102CA<br />2015CA7923091","factor(ecositeid): F022AD102CA<br />2015CA7921005","factor(ecositeid): F022AD102CA<br />2015CA7921006","factor(ecositeid): F022AD102CA<br />2015CA7921027","factor(ecositeid): F022AD102CA<br />2015CA7921028","factor(ecositeid): F022AD102CA<br />2015CA7921095","factor(ecositeid): F022AD102CA<br />2016CA7921016","factor(ecositeid): F022AD102CA<br />2016CA7925053","factor(ecositeid): F022AD102CA<br />2017CA7925011","factor(ecositeid): F022AD102CA<br />2012CA7921041","factor(ecositeid): F022AD102CA<br />2012CA7921067","factor(ecositeid): F022AD102CA<br />2013CA7927020","factor(ecositeid): F022AD102CA<br />2013CA7928207","factor(ecositeid): F022AD102CA<br />S2013CA107002","factor(ecositeid): F022AD102CA<br />2014CA7925059","factor(ecositeid): F022AD102CA<br />2014CA7925068","factor(ecositeid): F022AD102CA<br />2014CA7922008","factor(ecositeid): F022AD102CA<br />2014CA7925083","factor(ecositeid): F022AD102CA<br />2014CA7925075","factor(ecositeid): F022AD102CA<br />2014CA7925076","factor(ecositeid): F022AD102CA<br />2014CA7925078","factor(ecositeid): F022AD102CA<br />2014CA7922044","factor(ecositeid): F022AD102CA<br />2014CA7921003","factor(ecositeid): F022AD102CA<br />2014CA7921020","factor(ecositeid): F022AD102CA<br />S2014CA107004","factor(ecositeid): F022AD102CA<br />2014CA7925015","factor(ecositeid): F022AD102CA<br />2013CA7921065","factor(ecositeid): F022AD102CA<br />2013CA7921028","factor(ecositeid): F022AD102CA<br />2013CA7925014"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(196,154,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(196,154,0,1)"}},"hoveron":"points","name":"F022AD102CA","legendgroup":"F022AD102CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.40180166696807984,0.14504938187767258,-0.56324962688958091,-0.18518098513194511,-0.42791528877550444,-0.008729757771540371,-0.34121176559580935,-0.39368841697484486,-0.64781840188972373,-0.037441338359203255,-0.18010932376529451,-0.25102463187402657,0.29999572286445897,0.075016706205695588,-0.056560185343302753,-0.47170710252147841,-0.10434736474469629,-0.37543908768505357],"y":[-0.49492871534847943,-0.17251326380276419,-0.22152826706441109,0.36915535274027278,-0.076736223231115633,0.33987296974269571,-0.48791525092740201,-0.42949412825040978,0.079363536580393079,0.034411263844970619,-0.25761479748648231,-0.47524787480596109,-0.91035027216409492,-0.70822028351527555,-0.4869901752372725,-0.47353829906952438,-0.29786466127061645,-0.046595815365949318],"text":["factor(ecositeid): F022AD103CA<br />2014CA7922031","factor(ecositeid): F022AD103CA<br />2015CA7921031","factor(ecositeid): F022AD103CA<br />2019CA7921018","factor(ecositeid): F022AD103CA<br />2012CA7922003","factor(ecositeid): F022AD103CA<br />2012CA7922009","factor(ecositeid): F022AD103CA<br />2012CA7928004","factor(ecositeid): F022AD103CA<br />2012CA7928011","factor(ecositeid): F022AD103CA<br />2012CA7924011","factor(ecositeid): F022AD103CA<br />2012CA7921061","factor(ecositeid): F022AD103CA<br />2012CA7929003","factor(ecositeid): F022AD103CA<br />2012CA7929005","factor(ecositeid): F022AD103CA<br />2012CA7929009","factor(ecositeid): F022AD103CA<br />S2014CA107007","factor(ecositeid): F022AD103CA<br />2014CA7922045","factor(ecositeid): F022AD103CA<br />2014CA7921030","factor(ecositeid): F022AD103CA<br />2014CA7921051","factor(ecositeid): F022AD103CA<br />2014CA7921064","factor(ecositeid): F022AD103CA<br />2013CA7921033"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(153,168,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(153,168,0,1)"}},"hoveron":"points","name":"F022AD103CA","legendgroup":"F022AD103CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.45839857954648294,0.89557806746997604,0.65876444758316477,0.4659269623851735,0.45599953484299693,0.64515385753215493,0.77467603182515654,0.75556732138877225,0.39069949720831743,0.94368200169840633,0.49888402479140947,0.51558107770312744,0.50013443418679149,0.77332363885371536,0.75996603704415744,0.51853192683900851,0.81217286621967222,0.70300534682997795,0.49751197729199681,0.34756926701215601,0.64325931685324411,0.78217128329000363,0.59154681341038984,0.32483481157580979,0.34652554260825763,0.13793226400108086,0.6358311711728134,0.30571445844538864,0.29068192879438898,0.59378916721670694,0.61479402843275233,1.0413094576796615,0.44257102998032272,0.44929015819855628],"y":[-0.51166927805619056,-0.20519274818209582,-0.32137881074429803,-0.24296037551530705,0.2333883494107008,0.085296613514570574,0.07719726019002611,0.082150193529034729,-0.14779906193819503,-0.15655935187382888,0.069749246308429783,-0.17439906725794171,0.52894461311820973,-0.11664607096624602,0.38791134636337404,0.13446345133074028,0.17974722131722365,-0.4709893735671839,0.28457029611530438,0.161662664370569,0.39647510015560838,0.2537318047870829,-0.53914613378767029,0.0047962082790812431,0.081395499369157076,-0.4193777584852541,0.11821017342172593,0.41591911433295742,-0.2699454916484989,0.028377937059857382,0.2003334117114185,-0.099380176616289242,-0.13869333240034398,0.2988197678184768],"text":["factor(ecositeid): F022AD104CA<br />2015CA7923004","factor(ecositeid): F022AD104CA<br />2015CA7923020","factor(ecositeid): F022AD104CA<br />2015CA7923026","factor(ecositeid): F022AD104CA<br />2015CA7923027","factor(ecositeid): F022AD104CA<br />2015CA7923032","factor(ecositeid): F022AD104CA<br />2015CA7923038","factor(ecositeid): F022AD104CA<br />2015CA7923039","factor(ecositeid): F022AD104CA<br />2015CA7925004","factor(ecositeid): F022AD104CA<br />2015CA7925037","factor(ecositeid): F022AD104CA<br />2015CA7926017","factor(ecositeid): F022AD104CA<br />2015CA7921029","factor(ecositeid): F022AD104CA<br />2015CA7921034","factor(ecositeid): F022AD104CA<br />2015CA7921041","factor(ecositeid): F022AD104CA<br />2015CA7921093","factor(ecositeid): F022AD104CA<br />2016CA7921010","factor(ecositeid): F022AD104CA<br />2015CA7925080","factor(ecositeid): F022AD104CA<br />2015CA7925082","factor(ecositeid): F022AD104CA<br />2017CA7921009","factor(ecositeid): F022AD104CA<br />2016CA7922003","factor(ecositeid): F022AD104CA<br />2016CA7922005","factor(ecositeid): F022AD104CA<br />2016CA7925020","factor(ecositeid): F022AD104CA<br />2016CA7925021","factor(ecositeid): F022AD104CA<br />2017CA7925013","factor(ecositeid): F022AD104CA<br />2019CA7925026","factor(ecositeid): F022AD104CA<br />2019CA7925027","factor(ecositeid): F022AD104CA<br />2014CA7925069","factor(ecositeid): F022AD104CA<br />2014CA7925053","factor(ecositeid): F022AD104CA<br />2014CA7925081","factor(ecositeid): F022AD104CA<br />2014CA7925040","factor(ecositeid): F022AD104CA<br />2014CA7925044","factor(ecositeid): F022AD104CA<br />2014CA7921011","factor(ecositeid): F022AD104CA<br />2014CA7921021","factor(ecositeid): F022AD104CA<br />2014CA7921058","factor(ecositeid): F022AD104CA<br />2014CA7921059"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(83,180,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(83,180,0,1)"}},"hoveron":"points","name":"F022AD104CA","legendgroup":"F022AD104CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.055040948643826748,0.086513406160281886,0.1127949753998202,0.022704652398662907],"y":[0.23012586826648546,0.0052756801901719854,0.28756917091316525,0.14028467563652119],"text":["factor(ecositeid): F022AD105CA<br />2014CA7922043","factor(ecositeid): F022AD105CA<br />2014CA7921056","factor(ecositeid): F022AD105CA<br />2014CA7921057","factor(ecositeid): F022AD105CA<br />S2014CA107003"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,188,86,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,188,86,1)"}},"hoveron":"points","name":"F022AD105CA","legendgroup":"F022AD105CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.16622123619468587,-0.45605082354860943,-0.54201483850778442,-0.24894595490290522,-0.29150916898849655,-1.221817672080596,-0.72430652235528048,-0.091074416919046927,-0.6771738779527644,-0.0051327055330759822],"y":[-0.78119352459166069,0.46992322338111858,-0.027897826207560199,-0.72976009592533708,0.13478277683010539,-0.17993902090835304,0.15569165838166832,-0.44903655671240578,0.1908452193503237,-0.37588581298213625],"text":["factor(ecositeid): R022AD001CA<br />2016CA7921040","factor(ecositeid): R022AD001CA<br />2012CA7928003","factor(ecositeid): R022AD001CA<br />2012CA7924008","factor(ecositeid): R022AD001CA<br />2012CA7921054","factor(ecositeid): R022AD001CA<br />2012CA7929008","factor(ecositeid): R022AD001CA<br />2013CA7927024","factor(ecositeid): R022AD001CA<br />2013CA7927045","factor(ecositeid): R022AD001CA<br />2014CA7921053","factor(ecositeid): R022AD001CA<br />2013CA7921046","factor(ecositeid): R022AD001CA<br />2013CA7921053"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,192,148,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,192,148,1)"}},"hoveron":"points","name":"R022AD001CA","legendgroup":"R022AD001CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.60540142792845275,-0.39449001467808131,-0.57351373748329193,0.32189245188831134,-0.61023656126684178,-0.48384814489841377,-0.78779718371296192,0.028537873063383377,-0.45232452150962738,-0.64097139311280471,-0.17109285444003863,-0.72300955604318595,-0.30011052557116691,0.09298035003916176,0.10110903599356975,0.081627025666796665,-0.69490717846273165],"y":[0.35060677708497562,0.63556413410677948,0.4991899504290056,0.62464217476976269,0.92220892420788259,0.022991493224847628,0.73442373812511252,-0.2152028163991524,0.29203067268647337,0.24882636554635534,0.47552878379679026,0.33395706169085104,0.45251132168313724,0.5633629607931373,0.74638902074204272,0.72039776654797616,0.45801654163112765],"text":["factor(ecositeid): R022AD002CA<br />2015CA7926020","factor(ecositeid): R022AD002CA<br />2015CA7923095","factor(ecositeid): R022AD002CA<br />2015CA7923099","factor(ecositeid): R022AD002CA<br />2015CA7921032","factor(ecositeid): R022AD002CA<br />2016CA7921009","factor(ecositeid): R022AD002CA<br />2016CA7921039","factor(ecositeid): R022AD002CA<br />2015CA7925084","factor(ecositeid): R022AD002CA<br />2012CA7922005","factor(ecositeid): R022AD002CA<br />2012CA7922010","factor(ecositeid): R022AD002CA<br />2012CA7924004","factor(ecositeid): R022AD002CA<br />2012CA7921064","factor(ecositeid): R022AD002CA<br />2012CA7921070","factor(ecositeid): R022AD002CA<br />2014CA7922034","factor(ecositeid): R022AD002CA<br />2014CA7922038","factor(ecositeid): R022AD002CA<br />2014CA7921025","factor(ecositeid): R022AD002CA<br />2014CA7921060","factor(ecositeid): R022AD002CA<br />2013CA7921064"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"R022AD002CA","legendgroup":"R022AD002CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.21287010390362418,0.034291649546292199,-0.39551078968909037,-0.49577884784226073,0.1875596456913888,-0.10267106523119859,0.034615283108713014,-0.31405524694324477,0.46088313974626366,-0.085119797878218093,-0.26104987748343828,0.17527554607315479,0.20716808409417911,0.41071494030663863,0.24385197674090495,0.32648064633886514,0.39091108838045335],"y":[0.081370174700974518,-0.058644556156943473,0.022408142404431459,-0.31420611562088224,0.87618120324472248,0.38002841662703124,0.43981354440027104,0.6493725131838427,0.78028154936963368,0.5963839831086456,0.29695791188641529,-0.58834540223540455,-0.51708830655480864,0.40259431667397516,0.43201398599171886,0.35295534036898629,0.49375467349821606],"text":["factor(ecositeid): R022AD003CA<br />2015CA7921104","factor(ecositeid): R022AD003CA<br />2019CA7921009","factor(ecositeid): R022AD003CA<br />2012CA7928005","factor(ecositeid): R022AD003CA<br />2012CA7924005","factor(ecositeid): R022AD003CA<br />2012CA7921030","factor(ecositeid): R022AD003CA<br />2012CA7921066","factor(ecositeid): R022AD003CA<br />2012CA7921069","factor(ecositeid): R022AD003CA<br />2012CA7921071","factor(ecositeid): R022AD003CA<br />2012CA7927001","factor(ecositeid): R022AD003CA<br />2012CA7925001","factor(ecositeid): R022AD003CA<br />2013CA7927034","factor(ecositeid): R022AD003CA<br />2014CA7922019","factor(ecositeid): R022AD003CA<br />2014CA7925051","factor(ecositeid): R022AD003CA<br />2014CA7925080","factor(ecositeid): R022AD003CA<br />2014CA7922037","factor(ecositeid): R022AD003CA<br />2014CA7922039","factor(ecositeid): R022AD003CA<br />2014CA7921055"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,182,235,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,182,235,1)"}},"hoveron":"points","name":"R022AD003CA","legendgroup":"R022AD003CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.60969725468246039,-0.64260332451203961],"y":[0.70696256426034898,0.51074344231249713],"text":["factor(ecositeid): R022AD004CA<br />2015CA7926015","factor(ecositeid): R022AD004CA<br />2014CA7921012"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(6,164,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(6,164,255,1)"}},"hoveron":"points","name":"R022AD004CA","legendgroup":"R022AD004CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.53885381595728787],"y":[0.67956842890306202],"text":"factor(ecositeid): R022AD005CA<br />2015CA7921101","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(165,138,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(165,138,255,1)"}},"hoveron":"points","name":"R022AD005CA","legendgroup":"R022AD005CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.029920744339255286,0.65132813383635813,0.13522477889705437,0.36363622997534362,0.4887299679269243,0.51282345086007308,0.2610489624072716,0.09114486942673039,0.22354705381572459,0.17167455478168719,0.29541671869112318,0.52487980044663907,0.54591034346223255,0.4173875617668944,0.52886123489349623,0.17792583833410217],"y":[0.54377028457289533,0.060250555134996088,0.5516287678198637,0.46524634401705045,0.41860553778377402,0.33807183131208007,0.38838129937899946,0.15721865214292566,0.51717338683850111,0.62711636143227245,0.13611740299213507,0.39931889143199767,0.42053001277542529,0.4319481210898905,0.37529053209224145,0.26151852881813353],"text":["factor(ecositeid): R022AD007CA<br />2015CA7923019","factor(ecositeid): R022AD007CA<br />2015CA7923025","factor(ecositeid): R022AD007CA<br />2015CA7925030","factor(ecositeid): R022AD007CA<br />2015CA7925031","factor(ecositeid): R022AD007CA<br />2015CA7925022","factor(ecositeid): R022AD007CA<br />2015CA7921004","factor(ecositeid): R022AD007CA<br />2015CA7921033","factor(ecositeid): R022AD007CA<br />2017CA7921008","factor(ecositeid): R022AD007CA<br />2017CA7921011","factor(ecositeid): R022AD007CA<br />2019CA7921027","factor(ecositeid): R022AD007CA<br />2019CA7921030","factor(ecositeid): R022AD007CA<br />2019CA7925031","factor(ecositeid): R022AD007CA<br />2019CA7925032","factor(ecositeid): R022AD007CA<br />2019CA7925034","factor(ecositeid): R022AD007CA<br />2014CA7929004","factor(ecositeid): R022AD007CA<br />2014CA7925082"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(223,112,248,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(223,112,248,1)"}},"hoveron":"points","name":"R022AD007CA","legendgroup":"R022AD007CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.56106738924645927,-0.94383204059975001,0.21099839860993824,-0.95835572017779946,-0.48667653170530251,-0.6096118759341731,-0.54388969679577215,-0.91596687536203858,-0.86111261877631928,-0.20099824154436824,-0.84447993760551032,-0.97467734821218954],"y":[-0.3939361618119106,-0.094378022292245858,0.41841257540773308,0.15498630983071912,0.17019029923476711,0.28192899165922242,0.3551496804335601,-0.16827418664242783,0.073687557856972841,-0.072140866090928901,0.36904188350561035,-0.060499435465584006],"text":["factor(ecositeid): R022AD009CA<br />2014CA7922025","factor(ecositeid): R022AD009CA<br />2014CA7922030","factor(ecositeid): R022AD009CA<br />2017CA7921012","factor(ecositeid): R022AD009CA<br />2019CA7921015","factor(ecositeid): R022AD009CA<br />2012CA7922006","factor(ecositeid): R022AD009CA<br />2012CA7928008","factor(ecositeid): R022AD009CA<br />2013CA7927033","factor(ecositeid): R022AD009CA<br />S2014CA107002","factor(ecositeid): R022AD009CA<br />2014CA7921041","factor(ecositeid): R022AD009CA<br />2014CA7921042","factor(ecositeid): R022AD009CA<br />2014CA7921043","factor(ecositeid): R022AD009CA<br />2014CA7921050"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(251,97,215,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(251,97,215,1)"}},"hoveron":"points","name":"R022AD009CA","legendgroup":"R022AD009CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5029531082709988,-1.2110735758258153],"y":[0.25763373244933924,-0.48709856584824068],"text":["factor(ecositeid): R022AD010CA<br />2019CA7921013","factor(ecositeid): R022AD010CA<br />2019CA7925011"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,102,168,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(255,102,168,1)"}},"hoveron":"points","name":"R022AD010CA","legendgroup":"R022AD010CA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.76740204212694774,0.81887927795891013,0.73319177731009633,0.75377643975342268,0.094243102117668676,0.2954159622776657,0.40490953168161276,0.15290492194092489,0.55897030619290566,0.24337103802472387,-0.59945097407860537,-0.56465448744814128,-1.0927897866809482,-0.42559518372101829,-0.98170673495903593,-0.59296459857352746,-0.29242048605686038,-0.33439460802870752,-0.5495374565734723,-0.90780083904109021,-0.65297361784902586,0.39027939002202194,0.71278859128749139,0.62440386421413518,0.64722988541730586,-0.30765133418716345,-0.71488292298750089,-0.48916192342070969,-0.34085082968788344,-0.63718973305072446,-0.56545964182885367,-0.20926778627610726,-0.51382839313154338,-0.37470520026785914,-0.63487377158074076],"y":[-0.054907167080082003,0.20759051911946905,-0.11754618003745189,-0.073827017690322849,-0.7698273172593264,0.57386517189050523,0.26802466725543933,-0.33473837704261794,-0.6945203473749374,-0.71775537629266184,-0.0045461382874883369,-0.12071895785593009,0.51169517690264366,0.74428602782688058,-0.057730132987811496,-0.30570130231865089,-0.74464265697760512,0.28640520685451126,-0.19081725293556473,0.15616613459815989,0.23488865307127282,0.4387483088721198,-0.23603851296525466,0.0032278631887685113,-0.15449072267646069,0.37202482806061238,-0.35270504200262381,0.12062760992172006,0.57562162322113641,0.34450672941325555,0.44993207640477029,-0.57811266819633711,0.75879104285865728,0.67968864997382972,-0.16001150503120384],"text":["ABCO","CADE27","PILA","RIRO","ABMA","ARPA6","CECO","CHSE11","PYPI2","RIVI3","ACOC3","CARO5","CRAC3","ERWR","JUPA","PICOM","PIMO3","PENE3","ANCO","CAFI","ACMI2","PIJE","SYMO","KEGA","COTO","ERNU3","THFE","ELEL5","POSE","SEWA2","CAAP4","ELGL","ARTRV","JUGR7","POTR5"],"hovertext":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"textfont":{"size":7.559055118110237,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.48006209038145159,null,0,-0.046797542839543224,null,0,-0.17468556280785974,null,0,0.10336267404956857,null,0,0.42712624062231147,null,0,0.28194820202991749,null,0,0.5083396811701919,null,0,0.35930668353191803,null,0,0.18918619460223304,null,0,0.42877886830023243],"y":[0,0.073831254834584525,null,0,0.15074789037365324,null,0,-0.041916248141675265,null,0,0.11590089659864554,null,0,-0.043831764187314284,null,0,-0.079391561399978605,null,0,0.013414087830163193,null,0,-0.075261272295357853,null,0,-0.10093599547045852,null,0,0.055103043098885716],"text":"","type":"scatter","mode":"lines","line":{"width":1.1338582677165354,"color":"rgba(26,26,26,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.48006209038145159,-0.046797542839543224,-0.17468556280785974,0.10336267404956857,0.42712624062231147,0.28194820202991749,0.5083396811701919,0.35930668353191803,0.18918619460223304,0.42877886830023243],"y":[0.073831254834584525,0.15074789037365324,-0.041916248141675265,0.11590089659864554,-0.043831764187314284,-0.079391561399978605,0.013414087830163193,-0.075261272295357853,-0.10093599547045852,0.055103043098885716],"text":["elev_field","o_surf_thk","full_prof_clay_wtd","full_prof_ph_wtd","tmean","tmin","tmax","tdmean","vpdmin","vpdmax"],"hovertext":["","","","","","","","","",""],"textfont":{"size":15.118110236220474,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.144814090019572,"r":7.3059360730593621,"b":38.56490541422049,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Presence absence NMDS","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.6301662365685319,1.1685225859771946],"tickmode":"array","ticktext":["-1.5","-1.0","-0.5","0.0","0.5","1.0"],"tickvals":[-1.5,-1,-0.5,0,0.5,1],"categoryorder":"array","categoryarray":["-1.5","-1.0","-0.5","0.0","0.5","1.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"NMDS1","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.1193508950344455,1.0194260584575172],"tickmode":"array","ticktext":["-1.0","-0.5","0.0","0.5","1.0"],"tickvals":[-1,-0.5,0,0.5,1],"categoryorder":"array","categoryarray":["-1.0","-0.5","0.0","0.5","1.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"NMDS2","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205},"title":{"text":"Ecosite","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}}},"hovermode":"closest","width":825,"height":700,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"222833af8ea3":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"},"22283b1093cd":{"x":{},"y":{},"label":{}},"22286d2b8d6":{"x":{},"y":{},"xend":{},"yend":{}},"222833c5d3e7":{"x":{},"y":{},"label":{}}},"cur_data":"222833af8ea3","visdat":{"222833af8ea3":["function (y) ","x"],"22283b1093cd":["function (y) ","x"],"22286d2b8d6":["function (y) ","x"],"222833c5d3e7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nathan Roe.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
